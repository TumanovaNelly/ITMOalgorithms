# Задача №4: Отрезки и точки

## Описание задачи
Необходимо реализовать алгоритм, который определяет количество отрезков, содержащих каждую из заданных точек. Входные данные включают список отрезков и список точек, для которых нужно посчитать количество перекрывающих отрезков. Алгоритм должен выводить ответы для точек, отсортированных в возрастающем порядке.

## Структура кода
Код организован в две части: исходный код алгоритма для подсчета пересечений отрезков и точек, а также тесты для проверки корректности и производительности решения.

### Папка `src`
Папка с исходным кодом.

#### Файл `SectionsAndPoints.py`

1. **Константы**

   - **Описание**:
     - `START` — обозначает начало отрезка (`0`).
     - `POINT` — обозначает точку, для которой требуется посчитать количество пересечений (`1`).
     - `END` — обозначает конец отрезка (`2`).

2. **Функция `sections_n_points`**

   - **Параметры**:
     - `sections` (тип: `List[Tuple[int, int]]`) — список отрезков, где каждый отрезок представлен кортежем `(start, end)`.
     - `points` (тип: `List[int]`) — список целых чисел, представляющих точки, для которых нужно определить количество пересечений.

   - **Возвращаемое значение**:
     - `Iterator[int]` — итератор с количеством отрезков, которые содержат каждую точку из списка `points`.

   - **Описание**:
     - Создаёт объединённый список всех точек и границ отрезков с метками `START`, `POINT` и `END`.
     - Сортирует этот список с помощью алгоритма быстрой сортировки `quick_sort`.
     - Подсчитывает количество активных отрезков в процессе прохода по отсортированному списку:
       - При встрече `START` увеличивает счетчик активных отрезков.
       - При встрече `END` уменьшает счетчик активных отрезков.
       - При встрече `POINT` выдаёт текущее количество активных отрезков.
     - Работает за время `O((n + m) log(n + m))`, где `n` — количество отрезков, `m` — количество точек.

3. **Функция `sections_n_points_naive`**

   - **Параметры**:
     - `sections` (тип: `List[Tuple[int, int]]`) — список отрезков.
     - `points` (тип: `List[int]`) — список точек.

   - **Возвращаемое значение**:
     - `Iterator[int]` — итератор с количеством отрезков, которые содержат каждую точку из списка `points`.

   - **Описание**:
     - Решение грубой силой (наивный метод).
     - Для каждой точки проверяет, попадает ли она в каждый из отрезков.
     - Работает за время `O(n * m)`.

4. **Функция `main`**

   - **Описание**:
     - Считывает входные данные из файла `input.txt` с помощью функции `read()`.
     - Вызывает функцию `sections_n_points`, чтобы посчитать количество пересечений для каждой точки.
     - Записывает результаты в файл `output.txt` с помощью функции `write()`.

5. **Запуск программы**
   - Блок `if __name__ == "__main__":` вызывает функцию `main()` для выполнения программы.

### Папка `tests`
Папка с тестами.

#### Файл `SectionsAndPoints_test.py`

1. **Функция `test_sections_n_points`**

   - **Описание**:
     - Тестирует корректность работы функции `sections_n_points` на предопределённых данных.
     - Проверяет, что алгоритм правильно считает количество перекрытий точек отрезками.
     - Ожидаемый результат: `[0, 1, 3, 5, 4, 3, 2, 1, 0]`.

2. **Функция `test_sections_n_points_random`**

   - **Описание**:
     - Проверяет корректность работы функции `sections_n_points` на случайных данных.
     - Сравнивает результат оптимизированного алгоритма с наивным методом `sections_n_points_naive`.
     - Генерирует 1000 случайных отрезков и 1000 случайных точек для проверки.

3. **Функция `test_time`**

   - **Описание**:
     - Проверяет производительность функции `main` на больших входных данных.
     - Измеряет время выполнения и проверяет, что оно не превышает 2 секунд.

### Папка `txtf`
Папка с входными и выходными файлами.

#### Входные данные (`input.txt`)
Первые строчки содержат данные о координатах начала и конца отрезков. Последняя строка содержит информацию о координатах точек.  

#### Выходные данные (`output.txt`)
Содержит для каждой точки количество отрезков, пересекающих эту точку из входного списка. Данные разделены пробелом.

## Запуск программы и тестов

### Решение

1. Перейдите в папку с решением задачи:
```bash
cd ITMOalgorithms/Lab3/Task4/
```

2. Исходные данные находятся в папке `txtf` в файле `input.txt`. Чтобы открыть его в текстовом редакторе:
```bash
notepad txtf/input.txt
```

3. Запустите программу:
```bash
python src/SectionsAndPoints.py
```

4. Результаты будут записаны в `output.txt`. Чтобы открыть его в текстовом редакторе:
```bash
notepad txtf/output.txt
```

### Тестирование

1. Запустите тесты с помощью `pytest`:
```bash
pytest tests/SectionsAndPoints_test.py
```

